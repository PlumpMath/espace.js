/*! espace 2014-06-08; Copyright 2014 Adrian Toncean; released under the MIT license */
!function(){"use strict";function a(a,b){var c=new Error(b);throw c.coords=a.coords,c}var b={};b.parse=function(b){if(!b.length)return null;var c,d=[],e=null,f=b[0];if("("===f.type)e={token:f,tree:[]},c=e,d.push(e);else{if(")"!==f.type)return b.length>1&&a(f,"Unexpected token"),c={token:f};a(f,"Cannot start with )")}for(var g=1;g<b.length;g++)if(f=b[g],e||a(f,"Unexpected token"),"("===f.type){var h={token:f,tree:[]};e.tree.push(h),e=h,d.push(e)}else")"===f.type?(d.pop(),e=d[d.length-1]):e.tree.push({token:f});return d.length&&a(f,"Missing )"),c},window.espace=window.espace||{},window.espace.Parser=b}(),function(){"use strict";var a={};a.serialize=function(b){if(!b)return"";switch(b.token.type){case"string":return'"'+b.token.value+'"';case"number":return""+b.token.value;case"alphanum":return b.token.value;case"(":return"("+b.tree.map(function(b){return a.serialize(b)}).join(" ")+")"}},window.espace=window.espace||{},window.espace.Serializer=a}(),function(){"use strict";function a(a){this.string=a,this.pointer=0,this.marker=0,this.line=1,this.column=1}a.prototype.advance=function(){"\n"===this.current()?(this.line++,this.column=1):this.column++,this.pointer++},a.prototype.setMarker=function(a){a=a||0,this.marker=this.pointer+a},a.prototype.current=function(){return this.string.charAt(this.pointer)},a.prototype.next=function(){return this.string.charAt(this.pointer+1)},a.prototype.hasNext=function(){return this.pointer<this.string.length},a.prototype.getMarked=function(a){return a=a||0,this.string.substring(this.marker,this.pointer+a)},a.prototype.getCoords=function(){return{line:this.line,column:this.column}},window.espace=window.espace||{},window.espace.IterableString=a}(),function(){"use strict";function a(a){function b(a){var b=[];for(a.advance();;){if("\\"===a.current())a.advance(),n[a.current()]&&b.push(n[a.current()]);else{if("'"===a.current())return a.advance(),i("string",b.join(""),a.getCoords());if("\n"===a.current()||!a.hasNext()){var c=new Error("String not properly ended");throw c.coords=a.getCoords(),c}b.push(a.current())}a.advance()}}function c(a){var b=[];for(a.advance();;){if("\\"===a.current())a.advance(),n[a.current()]&&b.push(n[a.current()]);else{if('"'===a.current())return a.advance(),i("string",b.join(""),a.getCoords());if("\n"===a.current()||!a.hasNext()){var c=new Error("String not properly ended");throw c.coords=a.getCoords(),c}b.push(a.current())}a.advance()}}function d(a){a.setMarker();for(var b=a.current();b>="0"&&"9">=b;)a.advance(),b=a.current();if("."==a.current()){a.advance();for(var b=a.current();b>="0"&&"9">=b;)a.advance(),b=a.current()}if(-1===") \n	".indexOf(a.current())){var c=new Error("Unexpected character '"+a.current()+"' after '"+a.getMarked()+"'");throw c.coords=a.getCoords(),c}return i("number",+a.getMarked(),a.getCoords())}function e(a){for(a.setMarker(2),a.advance(),a.advance();;){if("-"===a.current()&&";"===a.next())return a.advance(),a.advance(),i("comment",a.getMarked(-2),a.getCoords());if(!a.hasNext()){var b=new Error("Multiline comment not properly terminated");throw b.coords=a.getCoords(),b}a.advance()}}function f(a){for(a.setMarker(1),a.advance();;){if("\n"===a.current()||!a.hasNext())return a.advance(),i("comment",a.getMarked(),a.getCoords());a.advance()}}function g(a){a.setMarker();for(var b=a.current();b>" "&&"~">=b&&"("!=b&&")"!=b;)a.advance(),b=a.current();return i("alphanum",a.getMarked(),a.getCoords())}function h(a){var b=a.current();return a.advance(),i("whitespace",b,a.getCoords())}a=a||{};var i,j,k=!!a.whitespace,l=!!a.comments,m=!!a.coords;m?(i=function(a,b,c){return{type:a,value:b,coords:c}},j=function(a,b){return{type:a,coords:b}}):(i=function(a,b){return{type:a,value:b}},j=function(a){return{type:a}});var n={"\\":"\\",n:"\n",t:"	","'":"'",'"':'"'};return function(a){for(var i=new espace.IterableString(a),m=[];i.hasNext();){var n=i.current();if("'"===n)m.push(b(i));else if('"'===n)m.push(c(i));else if(";"===n){var o=i.next();if("-"===o){var p=e(i);l&&m.push(p)}else{var p=f(i);l&&m.push(p)}}else if(n>="0"&&"9">=n)m.push(d(i));else if("("===n)m.push(j("(",i.getCoords())),i.advance();else if(")"===n)m.push(j(")",i.getCoords())),i.advance();else if(n>" "&&"~">=n)m.push(g(i));else{var p=h(i);k&&m.push(p)}}return m}}window.espace=window.espace||{},window.espace.Tokenizer=a}();